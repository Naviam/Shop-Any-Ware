@using TdService.Resources.Views
@model TdService.UI.Web.ViewModels.Account.ProfileViewModel
@{
    ViewBag.Title = ProfileViewResources.PageTitle;
}

<ul class="breadcrumb">
    <li>
        <a href="@Url.Action("Dashboard", "Member")">Dashboard</a> <span class="divider">/</span>
    </li>
    <li class="active">Profile</li>
</ul>
@if (Model.MessageType == "error")
{
    <div class="alert alert-error">
        <button class="close" data-dismiss="alert">×</button>
        <strong>Error: </strong>@Model.Message
    </div>
}
@using (Html.BeginForm("Save", "Profile", FormMethod.Post, new { @class = "form-horizontal" }))
{
    @Html.AntiForgeryToken()
    <input id="model" type="hidden" value="@(new System.Web.Script.Serialization.JavaScriptSerializer().Serialize(Model))" />
    <fieldset>
        @Html.HiddenFor(m => m.Id)
        <div class="control-group">
            <label class="control-label"><h2>@ProfileViewResources.PageHeader</h2></label>
        </div>
        <div class="control-group">
            <label class="control-label">@ProfileViewResources.EmailHeader:</label>
            <div class="controls">
                @Html.TextBoxFor(m => m.Email, new Dictionary<string, object> { { "class", "input-xlarge" }, { "data-bind", "value: email" }, { "readonly", "readonly" } })
            </div>
        </div>
@*        <div class="control-group">
            <label class="control-label">@ProfileViewResources.PasswordHeader:</label>
            <div class="controls">
                @Html.PasswordFor(m => m.CurrentPassword, new Dictionary<string, object> { { "class", "input-xlarge" }, { "data-bind", "value: currentPassword" }, { "readonly", "readonly" } })
            </div>
        </div>*@
        <div class="control-group">
            <label class="control-label">@ProfileViewResources.FirstNameHeader:</label>
            <div class="controls">
                @Html.TextBoxFor(m => m.FirstName, new Dictionary<string, object> { { "class", "input-xlarge" }, { "data-bind", "value: firstName" } })
                @Html.ValidationMessageFor(m => m.FirstName)
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">@ProfileViewResources.LastNameHeader:</label>
            <div class="controls">
                @Html.TextBoxFor(m => m.LastName, new Dictionary<string, object> { { "class", "input-xlarge" }, { "data-bind", "value: lastName" } })
                @Html.ValidationMessageFor(m => m.LastName)
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">@ProfileViewResources.NotificationHeader:</label>
            <div class="controls">
                <label class="checkbox">
                    @Html.CheckBoxFor(m => m.NotifyOnOrderStatusChanged, new Dictionary<string, object> { { "data-bind", "checked: notifyOnOrderStatusChange" } })
                    @Html.LabelFor(m => m.NotifyOnOrderStatusChanged, ProfileViewResources.Notification_OnOrderStatusChange)
                </label>
            </div>
            <div class="controls">
                <label class="checkbox">
                    @Html.CheckBoxFor(m => m.NotifyOnPackageStatusChanged, new Dictionary<string, object> { { "data-bind", "checked: notifyOnPackageStatusChange" } })
                    @Html.LabelFor(m => m.NotifyOnPackageStatusChanged, ProfileViewResources.Notification_OnPackageStatusChange)
                </label>
            </div>
        </div>
        <div class="form-actions">
            <button type="submit" data-bind="click: updateProfile" class="btn btn-primary">@ProfileViewResources.SaveChangesButton</button>
        </div>
    </fieldset>
}

@section Scripts
{
    <script type="text/javascript" src="@Url.Content("~/Scripts/model/ProfileViewModel.js")"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            ko.applyBindings(new ProfileViewModel($("#model").val()));
        });
    </script>
}